<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:MeetingApp.Models.ViewModels"
             x:Class="MeetingApp.Pages.AddMeetingPage"
             x:Name="ThisPage">

 

    <ScrollView>
        <VerticalStackLayout Padding="10" Spacing="15">

            <Entry Placeholder="Název schůzky" Text="{Binding Title}" />

            <DatePicker Date="{Binding Date}" />

            <TimePicker Time="{Binding StartTime}" />
            <TimePicker Time="{Binding EndTime}" />

            <Label Text="Barva schůzky (hex)" />
            <Entry Placeholder="#0078D7" Text="{Binding ColorHex}" />

            <Label Text="Opakování schůzky" />
            <Switch IsToggled="{Binding IsRegular}" />

            <Picker Title="Vyberte opakování"
                    ItemsSource="{Binding RecurrenceOptions}"
                    SelectedItem="{Binding SelectedRecurrence}" />

            <DatePicker Date="{Binding EndDate}" />

            <SearchBar Placeholder="Hledat účastníky"
                       Text="{Binding SearchText}" />

            <Label Text="Dostupní účastníci:" FontAttributes="Bold" />

            <CollectionView ItemsSource="{Binding FilteredUsers}">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Grid Padding="10">
                            <Grid.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding BindingContext.ToggleUserSelectionCommand, Source={x:Reference ThisPage}}"
                                                      CommandParameter="{Binding .}" />
                            </Grid.GestureRecognizers>
                            <Label Text="{Binding FirstName}" />
                        </Grid>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

            <Label Text="Vybraní účastníci:"  FontAttributes="Bold" />

            <CollectionView ItemsSource="{Binding SelectedUsers}">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Grid Padding="5" ColumnSpacing="10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>

                            <Label Grid.Column="0" Text="{Binding FirstName}" />

                            <Button Grid.Column="1"
                                    Text="Odebrat"
                                    Command="{Binding BindingContext.ToggleUserSelectionCommand, Source={x:Reference ThisPage}}"
                                    CommandParameter="{Binding .}" />
                        </Grid>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

            <Button Text="Uložit schůzku"
                    Command="{Binding SaveCommand}" />

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
